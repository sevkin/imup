# IMage UPloader

загрузка изображений и создание превьюшек размером 100х100

## Запуск

В докере `docker-compose up`
- пробрасывается порт `3000`
- загрузка в папку `/data` контейнера

Локально для отладки `make run`

### Ключи

- *-listen* - адрес:порт сервера
- *-storage* - папка для сохранения изображений
- *-thumbcmd* - скрипт обёртка для `convert`
- *-swagurl* - "видимый" url для swagger 

## API

- /api/v1/upload/form - *multipart/form-data*
- /api/v1/upload/json - *base64 json*
- /api/v1/upload/url - *ссылка на внешний ресурс*

Примеры с `curl` есть в `Makefile`

## Swagger

Доступен по адресу http://localhost:3000/swagger/index.html (по умолчанию). Параметр настраивается, пример настройки есть в `docker-compose.yml`

## Тумбы

Для создания превью используется `convert` из `imagemagick` который запускается субпроцессом в обработчике http запроса.

Количество одновременных субпроцессов лимитировано количеством ядер процессора. 
